<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Top 10 ‚Äì Fin de semaine en famille | Qu√©bec en Famille</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { font-family: 'Outfit', sans-serif; box-sizing: border-box; }

    /* ‚îÄ‚îÄ Theme colours ‚îÄ‚îÄ */
    .tc-arts      { color: #2563eb; }
    .tc-cinema    { color: #7c3aed; }
    .tc-visite    { color: #0891b2; }
    .tc-musique   { color: #db2777; }
    .tc-event     { color: #d97706; }
    .tc-expo      { color: #059669; }
    .tc-spectacle { color: #9333ea; }
    .tc-sport     { color: #ea580c; }

    /* ‚îÄ‚îÄ Date badge ‚îÄ‚îÄ */
    .date-badge {
      position: absolute; bottom: 8px; left: 8px; right: 8px;
      background: rgba(0,0,0,0.55); color: white; backdrop-filter: blur(4px);
      font-size: 0.62rem; font-weight: 700; padding: 3px 8px; border-radius: 6px;
      text-align: center; line-height: 1.3;
    }

    /* ‚îÄ‚îÄ Bookmark button ‚îÄ‚îÄ */
    .btn-bookmark {
      position: absolute; top: 10px; right: 10px; z-index: 3;
      background: rgba(0,0,0,0.38); border: none; cursor: pointer;
      width: 32px; height: 32px; border-radius: 50%; display: flex;
      align-items: center; justify-content: center; transition: transform 0.15s, background 0.15s;
    }
    .btn-bookmark:hover { transform: scale(1.18); background: rgba(0,0,0,0.55); }
    .btn-bookmark.saved { background: rgba(0,0,0,0.38); }
    .btn-bookmark .star { color: white; font-size: 1.1rem; line-height: 1; transition: color 0.15s; }
    .btn-bookmark.saved .star { color: #fbbf24; }

    /* ‚îÄ‚îÄ Selection card (horizontal) ‚îÄ‚îÄ */
    .sel-card {
      display: flex; background: white; border-radius: 16px;
      box-shadow: 0 2px 14px rgba(0,0,0,0.07); border: 1px solid #f1f5f9;
      overflow: hidden; transition: transform 0.18s, box-shadow 0.18s;
      text-decoration: none; color: inherit; margin-bottom: 16px;
      position: relative;
    }
    .sel-card:hover { transform: translateY(-3px); box-shadow: 0 8px 28px rgba(0,0,0,0.12); }
    .sel-card-img {
      width: 200px; min-width: 200px; flex-shrink: 0; position: relative; overflow: hidden;
    }
    .sel-card-img img { width: 100%; height: 100%; object-fit: cover; display: block; }
    .sel-card-img .sel-rank {
      position: absolute; top: 10px; left: 10px;
      background: #2563eb; color: white; border-radius: 50%;
      width: 28px; height: 28px; display: flex; align-items: center; justify-content: center;
      font-size: 0.75rem; font-weight: 800;
    }
    .sel-card-body {
      display: flex; flex-direction: column; flex: 1; padding: 18px 22px;
    }
    .sel-card-body .sel-theme {
      font-size: 0.68rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.08em;
    }
    .sel-card-body .sel-title {
      font-size: 1.1rem; font-weight: 800; color: #111827; margin: 4px 0 6px; line-height: 1.3;
    }
    .sel-card-body .sel-summary {
      font-size: 0.83rem; color: #374151; line-height: 1.5; flex: 1;
    }
    .sel-card-body .sel-meta {
      display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; align-items: center;
    }
    .sel-card-body .sel-meta-item {
      font-size: 0.75rem; color: #6b7280; display: flex; align-items: center; gap: 4px;
    }
    .sel-card-body .sel-prix {
      font-size: 0.72rem; font-weight: 700;
      background: #dcfce7; color: #15803d; padding: 3px 10px; border-radius: 999px;
      margin-left: auto;
    }
    .sel-why {
      display: inline-flex; align-items: center; gap: 4px;
      font-size: 0.68rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
      background: #fef3c7; color: #92400e; padding: 2px 8px; border-radius: 999px;
    }
    @media (max-width: 640px) {
      .sel-card { flex-direction: column; }
      .sel-card-img { width: 100%; min-width: unset; height: 180px; }
    }

    /* ‚îÄ‚îÄ Loading / empty states ‚îÄ‚îÄ */
    #loadingState, #emptyState { text-align: center; padding: 60px 20px; color: #94a3b8; }
  </style>
</head>
<body class="bg-slate-50 min-h-screen">

<!-- ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ -->
<header class="bg-white shadow-sm sticky top-0 z-50">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 flex justify-between items-center h-16">
    <a href="../index.html" class="flex items-center gap-1 no-underline">
      <span class="text-2xl font-extrabold text-blue-600">Qu√©bec</span>
      <span class="text-2xl font-extrabold text-gray-800">en Famille</span>
    </a>
    <a href="../index.html#wee"
       onclick="sessionStorage.setItem('openTab','wee')"
       class="text-sm font-semibold text-blue-600 hover:text-blue-800">
      ‚Üê Wee-QenF
    </a>
  </div>
</header>

<!-- ‚îÄ‚îÄ‚îÄ HERO ‚îÄ‚îÄ‚îÄ -->
<section class="bg-gradient-to-r from-blue-800 to-blue-600 pt-8 pb-10">
  <div class="max-w-4xl mx-auto px-4">
    <p class="text-blue-200 text-xs font-bold uppercase tracking-widest mb-1">Wee-QenF</p>
    <h1 class="text-white text-3xl md:text-4xl font-black leading-tight">
      Top 10 <span style="font-weight:400;opacity:.8">‚Äî</span> Nos incontournables
    </h1>
    <p class="text-blue-200 text-sm font-medium mt-2" id="subtitle">S√©lection pour la fin de semaine</p>
  </div>
</section>

<!-- ‚îÄ‚îÄ‚îÄ CONTENT ‚îÄ‚îÄ‚îÄ -->
<main class="max-w-4xl mx-auto px-4 py-8">
  <div id="loadingState">
    <div style="font-size:2rem;margin-bottom:12px">‚è≥</div>
    <p style="font-weight:700">Chargement de la s√©lection‚Ä¶</p>
  </div>
  <div id="emptyState" style="display:none">
    <div style="font-size:2rem;margin-bottom:12px">üò¥</div>
    <p style="font-weight:700">Aucune s√©lection disponible</p>
    <p style="font-size:0.85rem;margin-top:4px">Revenez depuis la page Wee-QenF pour voir le Top 10.</p>
    <a href="../index.html" onclick="sessionStorage.setItem('openTab','wee')"
       style="display:inline-block;margin-top:16px;background:#2563eb;color:white;padding:10px 24px;border-radius:999px;font-weight:700;text-decoration:none;font-size:0.85rem">
      Ouvrir Wee-QenF ‚Üí
    </a>
  </div>
  <div id="selList" style="display:none"></div>
</main>

<script>
// ‚îÄ‚îÄ Helpers (duplicated from index.html) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const MONTHS_FR = ['janvier','f√©vrier','mars','avril','mai','juin',
                   'juillet','ao√ªt','septembre','octobre','novembre','d√©cembre'];

function formatDateFR(d) {
  return `${d.getDate()} ${MONTHS_FR[d.getMonth()]} ${d.getFullYear()}`;
}

function getWeekend() {
  const now = new Date();
  const day = now.getDay(); // 0=Sun,1=Mon,...,6=Sat
  const daysUntilSat = day === 6 ? 0 : (6 - day);
  const sam = new Date(now); sam.setDate(now.getDate() + daysUntilSat); sam.setHours(0,0,0,0);
  const dim = new Date(sam); dim.setDate(sam.getDate() + 1); dim.setHours(23,59,59,999);
  return { sam, dim };
}

function themeCSS(t) {
  t = (t||'').toLowerCase().trim();
  if (t === 'sport')                         return 'tc-sport';
  if (t === 'spectacle')                     return 'tc-spectacle';
  if (t === 'arts' || t.startsWith('art'))   return 'tc-arts';
  if (t === 'cin√©ma' || t.includes('cin'))   return 'tc-cinema';
  if (t.includes('visit')||t.includes('guid')) return 'tc-visite';
  if (t.includes('musiqu'))                  return 'tc-musique';
  if (t.includes('expo'))                    return 'tc-expo';
  return 'tc-event';
}

function renderSelCard(ev, rank) {
  const lbl    = themeCSS(ev.theme);
  const badge  = ev.date ? `<div class="date-badge">${ev.date}</div>` : '';
  const desc   = (ev.description || '').trim();
  const summary = desc.length > 20
    ? desc.slice(0, 200) + (desc.length > 200 ? '‚Ä¶' : '')
    : `${ev.theme ? ev.theme.charAt(0).toUpperCase() + ev.theme.slice(1) + ' ‚Äî ' : ''}${ev.lieu||''}. Public : ${ev.age||'Tous'}.`;

  const { sam, dim } = getWeekend();
  const whyLabel = ev._whyLabel || '√Ä ne pas manquer';
  const whyHtml  = `<span class="sel-why">${whyLabel}</span>`;

  return `<div class="sel-card">
    <a href="${ev.URL||'#'}" target="_blank" rel="noopener noreferrer"
       style="display:flex;flex:1;text-decoration:none;color:inherit;overflow:hidden;">
      <div class="sel-card-img">
        <img src="${ev.image||'https://via.placeholder.com/600x300'}" alt="${(ev.titre||'').replace(/"/g,'&quot;')}" loading="lazy">
        <div class="sel-rank">${rank}</div>
        ${badge}
      </div>
      <div class="sel-card-body">
        <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
          <span class="sel-theme ${lbl}">${ev.theme||''}</span>
          ${whyHtml}
        </div>
        <div class="sel-title">${ev.titre||''}</div>
        <div class="sel-summary">${summary}</div>
        <div class="sel-meta">
          <span class="sel-meta-item">üìç ${ev.lieu||''}</span>
          <span class="sel-meta-item">√Çge : ${ev.age||'Tous'}</span>
          ${ev.prix ? `<span class="sel-prix">${ev.prix}</span>` : ''}
        </div>
      </div>
    </a>
  </div>`;
}

// ‚îÄ‚îÄ Load selection from sessionStorage ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function init() {
  const { sam, dim } = getWeekend();
  const dimDebut = new Date(sam.getTime() + 86400000);
  document.getElementById('subtitle').textContent =
    `Samedi ${formatDateFR(sam)} & Dimanche ${formatDateFR(dimDebut)}`;

  let selection = null;
  try {
    const raw = sessionStorage.getItem('top10');
    if (raw) selection = JSON.parse(raw);
  } catch(e) {}

  document.getElementById('loadingState').style.display = 'none';

  if (!selection || selection.length === 0) {
    document.getElementById('emptyState').style.display = 'block';
    return;
  }

  const list = document.getElementById('selList');
  list.style.display = 'block';
  list.innerHTML = selection.map((ev, i) => renderSelCard(ev, i + 1)).join('');
}

// Run on load ‚Äî also handle case where parent sets openTab
window.addEventListener('load', init);
</script>
</body>
</html>
